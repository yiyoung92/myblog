---
title: Docker 学习
Link: "[[学习笔记]]"
tags:
  - 领域/学习笔记/软件
date: 2025-04-20
key-words:
---
# Docker 学习
# Docker网络模式及容器间通信
==参考阅读==：[Docker网络模式详解及容器间通信](https://zhuanlan.zhihu.com/p/212772001)
Docker 主要有 **5 种网络模式**，区别如下：

---
### 1. **Bridge 模式（默认模式）**
- **特点**：  
  - 通过虚拟网桥 `docker0` 为容器分配==独立 IP== 
  - 容器间通过网桥通信，与宿主机隔离  
  - 需手动映射端口（`-p` 参数）才能被外部访问  
- **适用场景**：  
  - 单机环境下**容器间通信**（如微服务）  
  - 需要网络隔离的常规应用  

---
### 2. **Host 模式**
- **特点**：  
  - 直接共享宿主机的网络命名空间  
  - 容器使用宿主机 IP 和端口，**无需端口映射**  
  - 网络性能最佳，但失去隔离性（端口冲突风险）  
- **适用场景**：  
  - 高性能需求（如网络密集型应用）  
  - 临时测试或调试  

---
### 3. **None 模式**
- **特点**：  
  - 禁用所有网络接口  
  - 容器完全隔离，需手动配置网络（如自定义网卡）  
- **适用场景**：  
  - 高度定制化网络（如安全敏感场景）  
  - 特殊测试环境  

---
### 4. **Container 共享模式**
- **特点**：  
  - 共享指定容器的网络命名空间  
  - 多个容器共用 IP 和端口（类似 `localhost` 通信）  
- **适用场景**：  
  - 容器间紧密协作（如日志收集容器与主应用）  

---
### 5. **Overlay 模式（跨主机网络）**
- **特点**：  
  - 用于 Docker Swarm 集群，跨主机通信  
  - 通过 VXLAN 隧道实现容器网络互联  
- **适用场景**：  
  - 分布式系统、多节点微服务架构  

---

### 对比总结
| 模式         | 隔离性 | 性能   | 端口管理       | 典型用途               |
|--------------|--------|--------|----------------|------------------------|
| **Bridge**   | 高     | 中等   | 需映射端口     | 单机容器通信           |
| **Host**     | 无     | 最高   | 直接使用宿主机 | 高性能需求             |
| **None**     | 最高   | 无网络 | 手动配置       | 定制化/安全场景        |
| **Container**| 低     | 高     | 共享容器端口   | 容器组协作             |
| **Overlay**  | 高     | 中等   | 自动分配       | 跨主机集群（如 Swarm） |

选择时需权衡 **隔离性、性能、易用性**。例如：开发常用 `bridge`，生产集群用 `overlay`，调试临时用 `host`。

## 查看容器网络信息
可以通过 `docker network inspect bridge` 查看所有 `bridge` 网络模式下的容器,
可以通过 `docker network inspect host`查看所有 `host` 网络模式下的容器,
在 `Containers` 节点中可以看到容器名称。
host 网络模式需要在创建容器时通过参数 `--net host` 或者 `--network host` 指定，默认是bridg模式。

对于每个容器的 IP 地址和 Gateway 信息，我们可以通过 `docker inspect 容器名称|ID` 进行查看，在 `NetworkSettings` 节点中可以看到详细信息。

## 容器间网络通信
假设两个容器都是bridge网络模式，首先通过 `docker network inspect bridge` 查看两容器的具体 IP 信息。
执行`docker exec -it 容器名称或ID ping xxx.xx.xx.xx`，让一个容器去ping另一个容器的IP，测试通信与否。
通过创建自定义网络，可以进一步实现DNS功能，使用容器名称进行网络通信，具体查看上面参考阅读链接。
# Docker 镜像存储及迁移
